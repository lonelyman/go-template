# docker-compose.dev.yml
services:
  # --- Application Service ---
  app-dev:
    # container_name: my-awesome-app # ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢
    build:
      context: .
      dockerfile: build/dev/Dockerfile
    env_file:
      - .env
    environment:
      - DOCKER_ENV=true
      - APP_PORT=${APP_PORT}
      - HOST_PORT=${HOST_PORT}
    ports:
      - "${HOST_PORT}:${APP_PORT}"
    volumes:
      - .:/app
    networks:
      - app-network # üëà ‡∏ö‡∏≠‡∏Å‡πÉ‡∏´‡πâ app-dev ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô app-network

  # --- Migrate Service ---
  migrate:
    build:
      context: .
      dockerfile: build/dev/Dockerfile
    env_file:
      - .env # üëà ‡∏≠‡πà‡∏≤‡∏ô‡∏à‡∏≤‡∏Å .env ‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
    volumes:
      - .:/app
    networks:
      - app-network # üëà ‡∏ö‡∏≠‡∏Å‡πÉ‡∏´‡πâ migrate ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô app-network
  
  app-debug:
    build:
      context: .
      dockerfile: build/dev/Dockerfile
    env_file:
      - .env
    environment:
      - DOCKER_ENV=true
    ports:
      - "9997:9998" # üëà ‡πÉ‡∏ä‡πâ Port ‡∏≠‡∏∑‡πà‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏°
    networks:
      - app-network
    # ‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è ‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏´‡∏±‡∏ß‡πÉ‡∏à! ‡πÄ‡∏£‡∏≤‡∏à‡∏∞ override command ‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è
    # ‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ‡∏°‡∏±‡∏ô‡∏£‡∏±‡∏ô‡πÅ‡∏≠‡∏õ‡∏ï‡∏£‡∏á‡πÜ ‡πÄ‡∏•‡∏¢ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≤‡∏ô CompileDaemon
    command: ["go", "run", "./cmd/api/main.go"]

# ‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è ‡∏ö‡∏≠‡∏Å Docker Compose ‡∏ß‡πà‡∏≤ "‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô" ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÑ‡∏õ‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏±‡πâ‡∏ô
# ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏∞ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà!
networks:
  app-network:
    external: true